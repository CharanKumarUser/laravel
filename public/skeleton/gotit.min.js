class Gotit {
  constructor() {
    this.init();
  }

ShiftScheduleForm() {
  const typeSelector = $('[data-id="shift_type"]');
  const form = typeSelector.closest('.row');

  const toggleFields = () => {
    const type = typeSelector.val();
    $('#day-container, #week-container, #from-date-container, #to-date-container').addClass('d-none');
    if (type === 'day') {
      $('#day-container').removeClass('d-none');
    } else if (type === 'week') {
      $('#week-container, #day-container').removeClass('d-none');
    } else if (type === 'custom') {
      $('#from-date-container, #to-date-container, #day-container').removeClass('d-none');
    }
  };
  typeSelector.off('change').on('change', toggleFields);
  toggleFields();
}
shift() {
    console.info('Initializing shift form');
    const $breakAllowedSelect = $('select[name="break_allowed"]');
    const $breakFieldsContainer = $('#breakFieldsContainer');
    console.info('Break allowed select:', $breakAllowedSelect.val());


    function toggleBreakFields(value) {
        if ($breakFieldsContainer.length) {
            if (value === '1') {
                $breakFieldsContainer.removeClass('d-none');
            } else {
                $breakFieldsContainer.addClass('d-none');
            }
        }
    }

    if ($breakAllowedSelect.length) {
        toggleBreakFields($breakAllowedSelect.val());

        // Run when user changes the select
        $breakAllowedSelect.on('change', function () {
            toggleBreakFields($(this).val());
        });
    }
}

setupEmployeeNameAutoFill() {
    const firstNameField = document.getElementById('first_name');
    const lastNameField = document.getElementById('last_name');
    const deviceNameField = document.getElementById('name');
    function updateDeviceName() {
        const firstName = firstNameField.value.trim();
        const lastName = lastNameField.value.trim();
        if (firstName || lastName) {
            deviceNameField.value = `${firstName} ${lastName}`.trim();
        }
    }
    if (firstNameField && lastNameField && deviceNameField) {
        firstNameField.addEventListener('blur', updateDeviceName);
        lastNameField.addEventListener('blur', updateDeviceName);
    }
}


 async init() {
    try {
      if (!window.axios) throw new Error('Axios is required but not loaded');
      if (!window.jQuery) throw new Error('jQuery is required but not loaded');
      if (!jQuery.fn.DataTable) throw new Error('DataTables is required but not loaded');
      if (!window.Tagify) throw new Error('Tagify is required but not loaded');
      if (!window.bootstrap) throw new Error('Bootstrap is required but not loaded');

      this.setupEventListeners();
      this.configureToast();
      this.ShiftScheduleForm(); 

      this.log('Skeleton initialized');
    } catch (e) {
      this.error('Initialization error:', e);
      this.errorToast('Initialization Failed', 'Failed to initialize application');
    }
  }

  // Optional helper methods (replace with real implementations as needed)
  setupEventListeners() {}
  configureToast() {}
  log(...args) {
    console.log(...args);
  }
  error(...args) {
    console.error(...args);
  }
  errorToast(title, message) {
    alert(`${title}: ${message}`);
  }
}

document.addEventListener('DOMContentLoaded', () => {
  try {
    window.gotit = new Gotit();
  } catch (e) {
    console.error('Failed to initialize Skeleton:', e);
  }
});
